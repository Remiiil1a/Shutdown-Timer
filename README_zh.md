# 定时关机程序

## 一个美观易用的Windows定时关机、重启、注销工具...

---

### 注意:

### *1. 程序需要关机权限，建议以管理员身份运行*
### *2. 本项目的大部分代码由deepseek编写，是一个练习项目*
### *3. 使用本程序造成的任何后果由使用方自行承担*

---

## 功能特点

### 核心功能
- ⏰ **定时操作**：支持1-1440分钟（24小时）内的定时
- 🔄 **多种操作**：支持关机、重启、注销三种操作
- ⚙️ **操作模式**：支持强制关机（不保存应用数据）和正常关机
- 📊 **实时显示**：主窗口和托盘图标实时显示剩余时间
- 🗔 **系统托盘**：支持最小化到系统托盘，托盘图标右键菜单

### 用户界面
- 🎨 **现代化设计**：简洁的白色背景，深灰色文字
- 📱 **DPI自适应**：支持高DPI显示器
- 📍 **托盘集成**：完整的托盘图标功能
- 🔄 **状态提示**：清晰的状态提示和倒计时显示

---

## 使用方法

### 设置定时任务
1. 运行程序（建议以管理员身份运行）
2. 在"操作延迟时间"输入框中输入分钟数（1-1440）
3. 选择操作类型：关机、重启或注销
4. 选择操作方式：强制或正常（仅对关机和重启有效）
5. 点击"▶ 开始定时"按钮

### 取消定时任务
- 点击主窗口中的"⏹ 取消关机"按钮
- 或在系统托盘图标右键菜单中选择"⛔ 终止倒计时"

### 系统托盘操作
- **左键单击**：显示/隐藏主窗口
- **右键单击**：显示上下文菜单
  - 🔲 显示窗口
  - ⛔ 终止倒计时（仅在倒计时运行时显示）
  - ❌ 退出程序

### 关闭选项
点击窗口关闭按钮时，会弹出选项：
- **是(Y)** - 完全退出程序
- **否(N)** - 隐藏到系统托盘
- **取消** - 返回程序

---

## 技术细节

### 编译要求
- Windows SDK
- C++编译器（支持Windows API）
- 需要链接 `comctl32.lib`

### 权限要求
程序需要以下权限：
- 关机权限（建议管理员运行）
- 系统托盘访问权限
- 注册互斥体防止多开

### 系统要求
- Windows 7 或更高版本
- 支持Unicode
- 支持Common Controls 6.0

---

## 常见问题

### Q: 程序无法关机/重启怎么办？
A: 请尝试以管理员身份运行程序。

### Q: 程序可以多开吗？
A: 不可以，程序使用互斥体防止多开。

### Q: 定时时间可以超过24小时吗？
A: 不可以，最大支持24小时（1440分钟）。

### Q: 注销操作支持强制模式吗？
A: 不支持，强制模式仅对关机和重启有效。

### Q: 如何完全退出程序？
A: 可以通过托盘菜单退出，或关闭窗口时选择"是(Y)"。

---

[返回主页面]() | [查看英文版本](README_en.md)
